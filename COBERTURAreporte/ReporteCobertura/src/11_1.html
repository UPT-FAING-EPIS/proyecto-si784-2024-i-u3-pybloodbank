<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\UPT Sistemas 7Â°\calidad y pruebas software\Pruebas finales\FINAL\ProyectoU2 Version 9\ProyectoFinal\TestBancodeSangre.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using NUnit.Framework;
using System;
using System.Data;
using System.Drawing;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace Proyecto_Final_Blood_Bank.Tests
{
    [TestFixture]
    internal class TestBancodeSangre
    {
        private BANCO_DE_SANGRE form;

        [SetUp]
        public void SetUp()
        {
            // Configurar el formulario y el contexto de la prueba
            form = new BANCO_DE_SANGRE();
            form.Show(); // Mostrar el formulario para pruebas
        }

        [Test]
        public void TestBANCO_DE_SANGRE_Load()
        {
            // Llamar al m&#233;todo BANCO_DE_SANGRE_Load
            form.BANCO_DE_SANGRE_Load(null, EventArgs.Empty);
        }

        [Test]
        public void TestCargarGrilla()
        {
            // Llamar al m&#233;todo que carga la grilla
            form.CargarGrilla();

            // Verificar que el DataGridView se haya llenado con datos
            DataTable dt = form.dgvBancoSangre.DataSource as DataTable;
            Assert.That(dt, Is.Not.Null, &quot;El DataGridView no se ha llenado correctamente.&quot;);
            Assert.That(dt.Rows.Count, Is.GreaterThan(0), &quot;El DataGridView no contiene datos.&quot;);
        }

        [Test]
        public void TestCargarGrilla2()
        {
            // Llamar al m&#233;todo que carga la segunda grilla
            form.CargarGrilla2();

            // Verificar que el DataGridView se haya llenado con datos
            DataTable dt = form.dgvPacientes.DataSource as DataTable;
            Assert.That(dt, Is.Not.Null, &quot;El DataGridView de pacientes no se ha llenado correctamente.&quot;);
            Assert.That(dt.Rows.Count, Is.GreaterThan(0), &quot;El DataGridView de pacientes no contiene datos.&quot;);
        }

        [Test]
        public void TestButton1Click()
        {
            // Simular el texto de b&#250;squeda
            form.txtBuscar.Text = &quot;test&quot;;

            // Ejecutar el evento click del bot&#243;n Buscar
            form.button1_Click(null, EventArgs.Empty);
        }

        [Test]
        public void TestLabel3Click()
        {
            // Simular la acci&#243;n de clic en el label3 y verificar el resultado
            form.lblUsuario.Text = &quot;existingUser&quot;; // Simula un usuario v&#225;lido
            form.label3_Click(null, EventArgs.Empty);

            // Aqu&#237; puedes agregar verificaciones para asegurar que se abri&#243; el formulario correcto
            // Dependiendo de la implementaci&#243;n, podr&#237;as necesitar verificar el estado del formulario
        }

        [Test]
        public void TestOnMouseEnter()
        {
            // Simular el evento MouseEnter
            form.OnMouseEnter(null, EventArgs.Empty);

            // Verificar que la fuente de lblVolver haya cambiado
            Assert.That(form.lblVolver.Font, Is.EqualTo(new Font(&quot;Nirmala UI&quot;, 12F, FontStyle.Bold | FontStyle.Underline, GraphicsUnit.Point, 0)));
        }

        [Test]
        public void TestOnMouseLeave()
        {
            // Simular el evento MouseLeave
            form.OnMouseLeave(null, EventArgs.Empty);

            // Verificar que la fuente de lblVolver haya cambiado
            Assert.That(form.lblVolver.Font, Is.EqualTo(new Font(&quot;Nirmala UI&quot;, 9.75F, FontStyle.Bold | FontStyle.Underline, GraphicsUnit.Point, 0)));
        }

        [Test]
        public void TestResize()
        {
            // Simular un cambio de tama&#241;o en el formulario
            form.Size = new Size(1024, 768);
            form.BANCO_DE_SANGRE_Resize(null, EventArgs.Empty);
        }

        [TearDown]
        public void TearDown()
        {
            // Cerrar el formulario al finalizar las pruebas si no se ha cerrado
            if (form != null &amp;&amp; !form.IsDisposed)
            {
                form.Close();
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[17,9,17,10,1],[19,13,19,42,1],[20,13,20,25,1],[21,9,21,10,1],[25,9,25,10,1],[27,13,27,62,1],[28,9,28,10,1],[32,9,32,10,1],[34,13,34,33,1],[37,13,37,72,1],[38,13,38,93,1],[39,13,39,97,1],[40,9,40,10,1],[44,9,44,10,1],[46,13,46,34,1],[49,13,49,70,1],[50,13,50,106,1],[51,13,51,110,1],[52,9,52,10,1],[56,9,56,10,1],[58,13,58,42,1],[61,13,61,55,1],[62,9,62,10,1],[66,9,66,10,1],[68,13,68,51,1],[69,13,69,54,1],[73,9,73,10,1],[77,9,77,10,1],[79,13,79,54,1],[82,13,82,148,1],[83,9,83,10,1],[87,9,87,10,1],[89,13,89,54,1],[92,13,92,150,1],[93,9,93,10,1],[97,9,97,10,1],[99,13,99,45,1],[100,13,100,64,1],[101,9,101,10,1],[105,9,105,10,1],[107,13,107,50,1],[108,13,108,14,1],[109,17,109,30,1],[110,13,110,14,1],[111,9,111,10,1]]);
    </script>
  </body>
</html>